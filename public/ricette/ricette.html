<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Ricette - ZanellaZen</title>
  <script>
    (function() {
      var path = window.location.pathname || '/';
      var basePath = path.startsWith('/zanellazen') ? '/zanellazen' : '';
      window.__zanellazenBasePath = basePath;
      if (!document.querySelector('link[data-zz-main-style]')) {
        var prefix = basePath === '' ? '' : basePath;
        var link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = prefix + '/css/style.css';
        link.setAttribute('data-zz-main-style', 'true');
        document.head.appendChild(link);
      }
    })();
  </script>
<meta name="description" content="Ricette tradizionali italiane e piatti della tradizione culinaria di Stefano Zanella">
</head>
<body>
  <!-- Header -->
  <div data-include="/components/header.html"></div>

  <!-- Main Content -->
  <main class="main-content">
    <div class="container">
      <div class="page-header">
        <h1>üçù Ricette</h1>
        <div class="recipes-intro">
          <p><strong>RICETTE</strong> √® la parte del sito dedicata ai miei esperimenti culinari.</p>
          <p><strong><em>Buon Appetito !!!</em></strong></p>
        </div>
        <img
          src="data:image/gif;base64,R0lGODlhAQABAPAAAAAAAAAAACH5BAAAAAAALAAAAAABAAEAAAICRAEAOw=="
          data-zz-asset="/ricette/gallery/RICETTE.jpg"
          alt="Ricette"
          class="recipes-hero-image"
        >
      </div>

      <!-- Loading indicator -->
      <div id="loading-recipes" class="loading-indicator">
        <p>Caricamento ricette... üçΩÔ∏è</p>
      </div>

      <!-- Dynamic recipes container -->
      <div id="ricette-grid" class="ricette-grid" style="display: none;">
        <!-- Recipes will be loaded dynamically here -->
      </div>

      <!-- Error message -->
      <div id="recipes-error" class="error-message" style="display: none;">
        <p>‚ùå Errore nel caricamento delle ricette. Riprova pi√π tardi.</p>
      </div>
    </div>
  </main>

  <!-- Recipe Modal -->
  <div id="recipeModal" class="recipe-modal">
    <div class="recipe-modal-content">
      <div class="recipe-modal-header">
        <h2 id="modalRecipeTitle"></h2>
        <button class="recipe-modal-close" onclick="closeRecipeModal()">&times;</button>
      </div>
      <div id="modalRecipeContent" class="recipe-modal-body"></div>
    </div>
  </div>

  <!-- Footer -->
  <div data-include="/components/footer.html"></div>
  <script>
    (function() {
      var basePath = window.__zanellazenBasePath || (window.location.pathname.startsWith('/zanellazen') ? '/zanellazen' : '');
      var prefix = basePath === '' ? '' : basePath;
      ['include.js', 'script.js'].forEach(function(name) {
        if (document.querySelector('script[data-zz-asset="' + name + '"]')) return;
        var script = document.createElement('script');
        script.src = prefix + '/js/' + name;
        script.setAttribute('data-zz-asset', name);
        document.head.appendChild(script);
      });
    })();
  </script>
  <script>
    // Dynamic recipe loading
    document.addEventListener('DOMContentLoaded', async function() {
      const loadingEl = document.getElementById('loading-recipes');
      const gridEl = document.getElementById('ricette-grid');
      const errorEl = document.getElementById('recipes-error');

      try {
        // Determine correct API path
        const basePath = window.location.pathname.startsWith('/zanellazen') ? '/zanellazen' : '';
        const apiPath = basePath + '/api/recipes';

        // Fetch recipes from API
        const response = await fetch(apiPath);
        if (!response.ok) throw new Error('Failed to fetch recipes');

        const recipes = await response.json();

        // Group recipes by category
        const categories = {
          primi: { title: 'üçú Primi Piatti', recipes: [] },
          pesce: { title: 'üêü Secondi di Pesce', recipes: [] },
          carne: { title: 'ü•© Secondi di Carne', recipes: [] },
          dolci: { title: 'üç∞ Dolci', recipes: [] },
          altri: { title: 'üçΩÔ∏è Altri Piatti', recipes: [] }
        };

        // Sort recipes into categories
        recipes.forEach(recipe => {
          const category = recipe.category || 'altri';
          if (categories[category]) {
            categories[category].recipes.push(recipe);
          }
        });

        // Generate HTML for each category
        let html = '';
        Object.entries(categories).forEach(([key, category]) => {
          if (category.recipes.length > 0) {
            html += `
              <div class="recipe-category">
                <h2>${category.title}</h2>
                <div class="recipe-cards">
            `;

            category.recipes.forEach(recipe => {
              const description = getRecipeDescription(recipe.id);
              html += `
                <div class="recipe-card">
                  <div class="recipe-image">
                    <span class="recipe-emoji">${recipe.emoji}</span>
                  </div>
                  <h3>${recipe.title}</h3>
                  <p>${description}</p>
                  <button onclick="openRecipeModal('${recipe.id}')" class="recipe-link">Vai alla ricetta ‚Üí</button>
                </div>
              `;
            });

            html += `
                </div>
              </div>
            `;
          }
        });

        // Update DOM
        gridEl.innerHTML = html;
        loadingEl.style.display = 'none';
        gridEl.style.display = 'block';

      } catch (error) {
        console.error('Error loading recipes:', error);
        loadingEl.style.display = 'none';
        errorEl.style.display = 'block';
      }
    });

    // Recipe descriptions mapping
    function getRecipeDescription(id) {
      const descriptions = {
        'gulaschsuppe': 'Sostanziosa zuppa austro-ungarica con carne e paprika',
        'pasta-all-amatriciana': 'Il classico sugo piccante laziale con guanciale e pomodoro',
        'spaghetti-alla-carbonara': 'La vera ricetta romana della carbonara, semplice e perfetta',
        'risotto-ai-funghi': 'Cremoso risotto con funghi porcini della tradizione lombarda',
        'risotto-al-radicchio-di-treviso': 'Elegante risotto veneto con il pregiato radicchio rosso',
        'capesante-gratinate': 'Elegante antipasto di mare con capesante al forno',
        'capesante-all-olio': 'Semplici capesante saltate in padella con aglio e prezzemolo',
        'baccala-alla-vicentina': 'Piatto tradizionale veneto con baccal√† mantecato al latte',
        'mazzancolle-al-limone': 'Fresche mazzancolle saltate con limone e erbe aromatiche',
        'seppie-in-umido': 'Saporito secondo di mare della tradizione adriatica',
        'pollo-al-curry': 'Speziato piatto fusion con pollo e curry cremoso',
        'filetto-al-pepe-verde': 'Tenero filetto di manzo con salsa cremosa al pepe verde',
        'filetto-alla-wellington': 'Raffinato piatto inglese con filetto in crosta di pasta sfoglia',
        'tiramisu': 'Il re dei dolci italiani, cremoso e profumato al caff√®',
        'fritelle-di-mele': 'Dolci fritelle croccanti con mele fresche',
        'crostata-di-ricotta': 'Classica crostata della nonna con ripieno di ricotta',
        'crema-catalana': 'Delicata crema spagnola caramellata in superficie'
      };
      return descriptions[id] || 'Deliziosa ricetta della tradizione culinaria';
    }
  </script>
</body>
</html>
